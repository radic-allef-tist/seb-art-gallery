<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stupid, Evil, or Both: Artwork Gallery</title>

 
  <style>
    body { font-family: serif; background: #ffffff; margin: 0; padding: 20px; text-align: center; }
    
  
    
  .title-container {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  margin: 2rem 0 1rem 0;
}

.title-image {
  max-width: 90%;
  height: auto;
  width: 600px; /* nice limit on desktop */
  object-fit: contain;
  display: block;
}   
    
    
  
   h1 {
  font-size: clamp(2rem, 5vw, 4rem);
  font-family: serif;
  font-weight: bold;
  text-align: center;
  margin-bottom: 2vh;  /* increases vertical space relative to screen height */
  line-height: 1.2;
}

    h2 {
  font-size: clamp(2rem, 4vw, 3rem);
  font-family: serif;
  font-weight: bold;
  text-align: center;
  margin-bottom: 12vh;  /* increases vertical space relative to screen height */
  line-height: 1.2;
}
    
    .gallery {
  display: flex;
  flex-direction: column;
  gap: 6vh;           /* vertical spacing between each gallery-item */
  align-items: center;
  max-width: 90%;
  margin: 0 auto;
}

.gallery img {
  width: 70%;             /* relative for smaller screens */
  max-width: 800px;       /* caps size on large screens */
  height: auto;
  border-radius: 0.5rem;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}

.gallery img:hover {
  transform: scale(1.02);
  box-shadow: 0 0.5rem 0.75rem rgba(0,0,0,0.2);
}


  .gallery-item {
  text-align: center;

  margin-bottom: 2rem; /* small buffer if needed */
}

.caption {
  margin-top: 1rem;    
  font-size: 2rem;
  font-family: serif;
  color: #333;
  font-weight: bold;
}

    .angled-strike {
  position: relative;    /* relative for the pseudo-element */
  display: inline-block; /* ensures width matches text */
  color: inherit;        /* match h2 text color */
  font-size: inherit;    /* match h2 font size */
  font-family: inherit;  /* match h2 font */
  font-weight: inherit;  /* match h2 weight */
}

.angled-strike::after {
  content: "";
  position: absolute;
  left: 0;
  top: 45%;
  width: 100%;
  height: 0.25em;
  background-color: red;
  transform: rotate(-12deg);
  transform-origin: center;
}

.footer-content {
  display: flex;
  justify-content: space-between;
  align-items: flex-start; /* top-align buttons with text */
  flex-wrap: wrap;
  gap: 2rem;
}

.footer-text {
  flex: 2 1 500px; /* text gets most of the width */
}

.footer-buttons {
  flex: 1 1 200px; /* buttons column width */
  display: flex;
  flex-direction: column;
  align-items: flex-end; /* right-align buttons */
  gap: 1.5rem;
}

/* Override previous button container margins and widths */
.buy-print,
.buy-epub {
  margin: 0;
  max-width: none;
  align-items: flex-end; /* keep buttons right-aligned in column */
}

/* Keep responsive stacking on smaller screens */
@media (max-width: 768px) {
  .footer-content {
    flex-direction: column;
    align-items: center;
  }

  .footer-buttons {
    align-items: center;
  }

  .buy-print,
  .buy-epub {
    align-items: center;
  }
}


  .buy-print {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.75rem;
}

.buy-epub {
  display: flex;
  flex-direction: column;
  align-items: center; 
  gap: 0.75rem; 
}

.buy-button {
  display: inline-block;  
  border-radius: 0.5em;
  text-align: center;
  font-weight: bold;
  width: clamp(14rem, 50vw, 18rem);
  font-size: clamp(1.6rem, 2.5vh, 1.8rem);
  padding: clamp(0.9em, 2vw, 1.1em) clamp(1em, 3vw, 1.4em);
  text-decoration: none;
  color: white;
  box-shadow: 0 0.125em 0.375em rgba(0,0,0,0.2);
  transition: transform 0.1s ease, box-shadow 0.1s ease;
}

.buy-button.print {
  background-color: #2d6a4f;
  border: 0.15em solid #1b4332;
}

.buy-button.epub {
  background-color: #1d3557;
  border: 0.15em solid #0b1e33;
}

.buy-button:hover {
  transform: scale(1.03);
  box-shadow: 0 0.25em 0.5em rgba(0,0,0,0.3);
}


    
    
  #closeModal, #refreshModal {
  position: absolute;
  right: 2vw;
  z-index: 1100;
  
  width: 5rem;   /* bigger box */
  height: 5rem;
  font-size: 4rem; /* bigger icon */
  
  display: flex;
  justify-content: center;
  align-items: center;

  background: rgba(0,0,0,0.6);
  border: 0.15rem solid white; /* slightly thicker border for larger box */
  color: white;
  cursor: pointer;
  border-radius: 0.5rem;
  text-shadow: 0 0 0.3rem rgba(0,0,0,0.7);
  box-shadow: 0 0 0.5rem rgba(0,0,0,0.3);
  transition: transform 0.2s ease, background-color 0.2s ease,
              color 0.2s ease, box-shadow 0.2s ease;
}

#closeModal { top: 2vh; }
#refreshModal { top: calc(2vh + 5rem + 2vh);  padding-top: 0;  padding-bottom: 0.2rem; }  /* top of Close + its height + margin *//* adjust spacing as needed */


/* Desktop hover effect */
@media (hover: hover) and (pointer: fine) {
  #closeModal:hover,
  #closeModal:focus,
  #refreshModal:hover,
  #refreshModal:focus {
    background-color: white;
    color: black;
    transform: scale(1.2);
    box-shadow: 0 0.3rem 0.5rem rgba(0,0,0,0.5);
    outline: none;
  }
}

    
/* Mobile flash effect */
.tapped {
  background-color: rgba(255,255,255,0.7) !important;
  color: black !important;
  transform: scale(1.2) !important;
  box-shadow: 0 0.3rem 0.5rem rgba(0,0,0,0.5) !important;
  transition: transform 0.15s ease, background-color 0.15s ease, color 0.15s ease, box-shadow 0.15s ease !important;
}

/* Accessibility: show focus ring for keyboard users */
:focus-visible {
  outline: 0.18rem solid rgba(255,255,255,0.6);
  outline-offset: 0.15rem;
}

/* Slightly larger on very small screens for easier tapping */
@media (max-width: 480px) {
  #closeModal, #refreshModal {
    width: 5.6rem;
    height: 5.6rem;
    font-size: 2.8rem;
    border-radius: 0.6rem;
    border: 0.14rem solid white;
  }
  #refreshModal { top: 12vh; } /* bump refresh a bit on small screens */
}
#backToTop {
  display: none;
  position: fixed;
  bottom: 2vh;
  right: 4vw;
  z-index: 99;
  width: clamp(4rem, 10vw, 5rem);   /* bigger minimum on mobile */
  height: clamp(4rem, 10vw, 5rem);  /* keep circle proportional */
  background-color: white;
  color: #333;
  border: 2px solid #333;
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 0.3vw 0.8vw rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.1s ease, opacity 0.1s ease; /* faster */
}

#backToTop:hover,
#backToTop.pressed {
  background-color: #333;
  color: white;
  transform: scale(1.1);
}

#backToTop svg {
  width: 70%;  /* arrow fills ~70% of circle */
  height: 70%;
}




    
  </style>
  
  </head>
  
<body>
  <h1 class="title-container">
  <img 
    src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/Title.webp"
    alt="Stupid, Evil, or Both: A Collection of Rants"
    class="title-image">
</h1>

 <div class="footer">
  <div class="footer-content">
    
    <div class="footer-text">
      <p>Hey all, if you've found this site then you read my book, found my socials, or have one of the QR codes I left lying around. Either way, welcome!</p> 
      <p>I made this extremely bare bones site to host the higher-res version of the art from my book. Between Print-On-Demand inconsistencies and unpredicatable EPUB compression issues, the art kinda got wrecked sometimes.</p>      
      <p>Look — I know it's garbage-tier work. I'm not an artist. It took me an unreasonable amount of time to draw this shit. But it got the message across, yeah?</p>
      <p>Anyway, I'd appreciate it if you didn't, like... steal it all to sell on an Etsy shop or whatever without telling me. Hook me up!</p> 
      <p>
        Contact me: 
        <a href="https://bsky.app/profile/radic-allef-tist.bsky.social" target="_blank" rel="noopener noreferrer">
          @radic-allef-tist.bsky.social
        </a> 
        and I can license you the unwatermarked versions or something (I know the watermarks I put on are just <i>so</i> toxic). I don't know how this stuff works, but we can work a deal out.
      </p>

      <p>Let me know if the buy lunks here break or if the book gets removed by our glorious "free speech absolutists".</p>
      <p>Thanks again to everyone for the support. Stay strong out there.</p>
        
      <p>-Radic</p>
    </div>

    <div class="footer-buttons">
      <div class="buy-print">
        <a href="https://a.co/d/5li0CfB" class="buy-button print">Buy Print Edition</a>
      </div>

      <div class="buy-epub">
        <a href="https://books2read.com/u/m0PGLl" class="buy-button epub">Buy eBook</a>
      </div>
    </div>

  </div>
</div>
  
<div class="gallery">

  
  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/OUR_VOTE_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/OUR_VOTE_Watermarked.webp"
      alt="Our Vote"
      class="gallery-img">
    <div class="caption">OUR VOTE</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/TRUMP_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/TRUMP_Watermarked.webp"
      alt="Donald J. Trump"
      class="gallery-img">
    <div class="caption">DONALD J. TRUMP</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/CAPITALISM_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/CAPITALISM_Watermarked.webp"
      alt="Capitalism"
      class="gallery-img">
    <div class="caption">CAPITALISM</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/TAXES_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/TAXES_Watermarked.webp"
      alt="Taxes"
      class="gallery-img">
    <div class="caption">TAXES</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/HEALTHCARE_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/HEALTHCARE_Watermarked.webp"
      alt="Healthcare"
      class="gallery-img">
    <div class="caption">HEALTHCARE</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/EDUCATION_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/EDUCATION_Watermarked.webp"
      alt="Education"
      class="gallery-img">
    <div class="caption">EDUCATION</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/ENVIRONMENT_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/ENVIRONMENT_Watermarked.webp"
      alt="The Environment"
      class="gallery-img">
    <div class="caption">THE ENVIRONMENT</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/BIGOTRY_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/BIGOTRY_Watermarked.webp"
      alt="Bigotry"
      class="gallery-img">
    <div class="caption">BIGOTRY</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/JUSTICE_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/JUSTICE_Watermarked.webp"
      alt="Justice"
      class="gallery-img">
    <div class="caption">JUSTICE</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/RELIGION_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/RELIGION_Watermarked.webp"
      alt="Religion"
      class="gallery-img">
    <div class="caption">RELIGION</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/FINAL_RANT_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/FINAL_RANT_Watermarked.webp"
      alt="Final Rant"
      class="gallery-img">
    <div class="caption">FINAL RANT</div>
  </div>

  <div class="gallery-item">
    <img 
      src="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP_Thumbnails/FULL_COVER_ART_Watermarked_Thumbnail.webp"
      data-full="https://cdn.jsdelivr.net/gh/radic-allef-tist/seb-art-gallery@main/Watermarked_WebP/FULL_COVER_ART_Watermarked.webp"
      alt="Full Cover Art"
      class="gallery-img">
    <div class="caption">FULL COVER ART</div>
  </div>


</div>

  


    <!-- Modal -->

<div id="imageModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
            background:rgba(0,0,0,0.9); justify-content:center; align-items:center; z-index:1000;">

 <!-- Close button inside modal -->
<button id="closeModal">✕</button>

<!-- Refresh button inside modal -->
<button id="refreshModal">&#x21bb;</button>

  <!-- Progress bar container (centered & responsive) -->
  <div id="modalProgressContainer" style="
      position:absolute; 
      top:50%; left:50%; transform:translate(-50%, -50%);
      width:40vw;      /* 40% of viewport width */
      max-width:300px; /* optional max width */
      height:1vh;      /* 1% of viewport height */
      max-height:8px;  /* optional max height */
      background:rgba(255,255,255,0.2); 
      border-radius:0.5vh; 
      z-index:1010;">
    <div id="modalProgressBar" style="
      width:0%; 
      height:100%; 
      background:#fff; 
      border-radius:0.5vh; 
      transition: width 0.3s ease;"></div>

     <div id="modalProgressMessage" style="
      position:absolute;
      top: calc(50% + 2vh);
      left: 50%;
      transform: translateX(-50%);
      color: white;
      font-size: 1rem;
      text-align: center;
      display: none;
      white-space: nowrap;
      max-width: 90vw;
      z-index: 1011;">
      </div>
    
  </div>

  <!-- Full image -->
  <img id="modalImage" src="" style="max-width:90%; max-height:90%; object-fit:contain; z-index:1000;">
</div>


    
<script>
const modal = document.getElementById('imageModal');
const modalImg = document.getElementById('modalImage');
const closeBtn = document.getElementById('closeModal');
const refreshBtn = document.getElementById('refreshModal');
const progressBar = document.getElementById('modalProgressBar');


let scale = 1, originX = 0, originY = 0;
let startX = 0, startY = 0, isDragging = false;
let initialDistance = 0, initialScale = 1;
let lastTouchX = 0, lastTouchY = 0;
let lastPinchTime = 0, pinchMidX = 0, pinchMidY = 0;

let progressInterval = null;
const MIN_PROGRESS_TIME = 500;

// --------------------
// Open modal with progress
// --------------------
document.querySelectorAll('.gallery-img').forEach(img => {
  img.addEventListener('click', e => {
    e.preventDefault();

    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    scale = 1; originX = 0; originY = 0;
    modalImg.style.transform = `translate(0px,0px) scale(1)`;
    modalImg.style.cursor = 'zoom-in';
    progressBar.style.width = '0%';
    progressBar.parentElement.style.display = 'block';
    modalImg.style.opacity = '0';
    modalImg.src = '';

    // Reference the message element
    const progressMessage = document.getElementById('modalProgressMessage');
    progressMessage.style.display = 'none';

    // Track all timeouts so we can clear them if image loads
    const messageTimeouts = [];

    // Message after 3 seconds
    messageTimeouts.push(setTimeout(() => {
      progressMessage.textContent = 'These images are kinda big...';
      progressMessage.style.display = 'block';
    }, 5000));

    // Message after 8 seconds
    messageTimeouts.push(setTimeout(() => {
      progressMessage.textContent = 'Your connection to these servers is shit...';
      progressMessage.style.display = 'block';
    }, 15000));

    // Message after 15 seconds
    messageTimeouts.push(setTimeout(() => {
      progressMessage.textContent = 'Might as well keep waiting...';
      progressMessage.style.display = 'block';
    }, 25000));

    const xhr = new XMLHttpRequest();
    xhr.open('GET', img.dataset.full, true);
    xhr.responseType = 'blob';

    xhr.onprogress = (event) => {
      if (event.lengthComputable) {
        const percent = Math.round((event.loaded / event.total) * 100);
        progressBar.style.width = percent + '%';
      }
    };

    xhr.onload = () => {
      const blobUrl = URL.createObjectURL(xhr.response);

      const finish = () => {
        progressBar.style.width = '100%';
        modalImg.src = blobUrl;
        modalImg.style.opacity = '1';
        setTimeout(() => {
          progressBar.parentElement.style.display = 'none';
          progressMessage.style.display = 'none';
        }, 100);

        // clear all pending messages
        messageTimeouts.forEach(timeout => clearTimeout(timeout));
      };

      finish();
    };

    xhr.onerror = () => {
      modalImg.src = img.dataset.full;
      modalImg.style.opacity = '1';
      progressBar.parentElement.style.display = 'none';
      progressMessage.style.display = 'none';
      messageTimeouts.forEach(timeout => clearTimeout(timeout));
    };

    xhr.send();
  });
});
  
// --------------------
// Detect input type
// --------------------
let usingMouse = false;
window.addEventListener('mousemove', () => usingMouse = true);
window.addEventListener('touchstart', () => usingMouse = false);
const isDesktop = () => usingMouse;

// --------------------
// Desktop zoom & drag
// --------------------
modalImg.addEventListener('click', e => {
  if (!isDesktop()) return;
  if (scale === 1 && !e.touches) {
    const rect = modalImg.getBoundingClientRect();
    const offsetX = e.clientX - rect.left;
    const offsetY = e.clientY - rect.top;
    const newScale = 2;
    originX = offsetX - (offsetX - originX) * (newScale / scale);
    originY = offsetY - (offsetY - originY) * (newScale / scale);
    scale = newScale;
    modalImg.style.transform = `translate(${originX}px,${originY}px) scale(${scale})`;
    modalImg.style.cursor = 'grab';
  }
});

modal.addEventListener('wheel', e => {
  if (!isDesktop()) return;
  e.preventDefault();
  const rect = modalImg.getBoundingClientRect();
  const offsetX = e.clientX - rect.left;
  const offsetY = e.clientY - rect.top;
  const zoomFactor = Math.exp(-e.deltaY * 0.0025);
  const newScale = Math.min(Math.max(scale * zoomFactor, 1), 10);
  originX = newScale === 1 ? 0 : offsetX - ((offsetX - originX) * newScale) / scale;
  originY = newScale === 1 ? 0 : offsetY - ((offsetY - originY) * newScale) / scale;
  scale = newScale;
  modalImg.style.transform = `translate(${originX}px,${originY}px) scale(${scale})`;
  modalImg.style.cursor = scale > 1 ? 'grab' : 'zoom-in';
});

modalImg.addEventListener('mousedown', e => {
  if (!isDesktop() || scale <= 1) return;
  isDragging = true;
  startX = e.clientX - originX;
  startY = e.clientY - originY;
  modalImg.style.cursor = 'grabbing';
  e.preventDefault();
});
window.addEventListener('mousemove', e => {
  if (!isDesktop() || !isDragging) return;
  originX = e.clientX - startX;
  originY = e.clientY - startY;
  modalImg.style.transform = `translate(${originX}px,${originY}px) scale(${scale})`;
});
window.addEventListener('mouseup', () => {
  if (!isDesktop()) return;
  if (isDragging) { isDragging = false; modalImg.style.cursor = scale > 1 ? 'grab' : 'zoom-in'; }
});

// --------------------
// Mobile pinch & drag
// --------------------
modal.addEventListener('touchstart', e => {
  if (e.touches.length === 1) {
    lastTouchX = e.touches[0].clientX;
    lastTouchY = e.touches[0].clientY;
  } else if (e.touches.length === 2) {
    const [t1, t2] = e.touches;
    initialDistance = Math.hypot(t1.clientX - t2.clientX, t1.clientY - t2.clientY);
    initialScale = scale;
    pinchMidX = (t1.clientX + t2.clientX) / 2;
    pinchMidY = (t1.clientY + t2.clientY) / 2;
  }
}, { passive: false });

modal.addEventListener('touchmove', e => {
  if (e.touches.length === 1) {
    if (Date.now() - lastPinchTime < 50) return;
    e.preventDefault();
    const touch = e.touches[0];
    originX += touch.clientX - lastTouchX;
    originY += touch.clientY - lastTouchY;
    lastTouchX = touch.clientX;
    lastTouchY = touch.clientY;
    modalImg.style.transform = `translate(${originX}px,${originY}px) scale(${scale})`;
  } else if (e.touches.length === 2) {
    e.preventDefault();
    const [t1, t2] = e.touches;
    const currentDistance = Math.hypot(t1.clientX - t2.clientX, t1.clientY - t2.clientY);
    let newScale = Math.min(Math.max(initialScale * (currentDistance / initialDistance), 1), 10);
    const dx = ((t1.clientX+t2.clientX)/2) - pinchMidX;
    const dy = ((t1.clientY+t2.clientY)/2) - pinchMidY;
    originX = (originX + dx) * (newScale / scale);
    originY = (originY + dy) * (newScale / scale);
    scale = newScale;
    pinchMidX = (t1.clientX+t2.clientX)/2;
    pinchMidY = (t1.clientY+t2.clientY)/2;
    lastPinchTime = Date.now();
    modalImg.style.transform = `translate(${originX}px,${originY}px) scale(${scale})`;
  }
}, { passive: false });

// --------------------
// Reset & Close with mobile tap flash and hybrid support
// --------------------

// Detect if device supports touch
const isTouchDevice = () => ('ontouchstart' in window || navigator.maxTouchPoints > 0);

// Tap/flash effect
function flashButton(btn) {
  if (!btn) return;
  btn.classList.add('tapped');
  setTimeout(() => btn.classList.remove('tapped'), 150);
}

// Reset image zoom/position
const resetModalImage = (e) => {
  scale = 1;
  originX = 0;
  originY = 0;
  modalImg.style.transform = `translate(0px,0px) scale(1)`;
  modalImg.style.cursor = 'zoom-in';

  // Flash for mobile/hybrid tap
  if (e && e.target && isTouchDevice()) flashButton(e.target);

  // Clear focus/hover properly
  if (e && e.target) setTimeout(() => e.target.blur(), 0);
  if (document.activeElement && document.activeElement !== document.body) {
    setTimeout(() => document.activeElement.blur(), 0);
  }
};

// Close modal handler
const closeModal = (e) => {
  if (e && e.target && isTouchDevice()) flashButton(e.target);

  // Slight delay so flash is visible
  setTimeout(() => {
    modal.style.display = 'none';
    document.body.style.overflow = '';
    resetModalImage();
    modalImg.src = '';
    progressBar.style.width = '0%';
    progressBar.parentElement.style.display = 'none';
    if (progressInterval) {
      clearInterval(progressInterval);
      progressInterval = null;
    }
  }, 120);
};

// Refresh button
refreshBtn.addEventListener('click', resetModalImage); // desktop & desktop hybrid
refreshBtn.addEventListener('touchend', e => {
    resetModalImage(e);    // flash + reset
    e.preventDefault();    // prevent double trigger
}, { passive: false });

// Close button
closeBtn.addEventListener('click', closeModal); // desktop & desktop hybrid
closeBtn.addEventListener('touchend', e => {
    closeModal(e);        // flash + close
    e.preventDefault();    // prevent double trigger
}, { passive: false });
  
// Close modal on click outside or Escape
modal.addEventListener('click', e => { if (e.target === modal) closeModal(e); });
document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(e); });
</script>


<!-- BACK TO TOP ARROW -->
  
<button id="backToTop" title="Go to top" aria-label="Back to top">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
       fill="none" stroke="currentColor" stroke-width="3"
       stroke-linecap="round" stroke-linejoin="round"
       style="width: 70%; height: 70%;">
    <polyline points="18 15 12 9 6 15" />
  </svg>
</button>

<script>
  const backToTopBtn = document.getElementById("backToTop");
  let scrollCheck = null;

  // Show/hide button on scroll and reset pressed when at the very top
  window.addEventListener("scroll", () => {
    const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
    backToTopBtn.style.display = scrollTop > 300 ? "block" : "none";

    if (scrollTop === 0) {
      resetButtonEffects();
    }
  });

  // --- Helper to remove pressed visuals ---
  const resetButtonEffects = () => {
    backToTopBtn.classList.remove("pressed");
    // if you used inline styles anywhere, clear them here as well:
    backToTopBtn.style.backgroundColor = "";
    backToTopBtn.style.color = "";
    backToTopBtn.style.transform = "";
  };

  // --- Smooth scroll to top (keeps checking and clears pressed when done) ---
  const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: "smooth" });

    // clear any previous check
    if (scrollCheck) {
      clearInterval(scrollCheck);
      scrollCheck = null;
    }

    // Safety: when we reach top, ensure visual state is reset
    scrollCheck = setInterval(() => {
      if ((window.scrollY || document.documentElement.scrollTop) === 0) {
        resetButtonEffects();
        clearInterval(scrollCheck);
        scrollCheck = null;
      }
    }, 50);
  };

  // --- Desktop click (normal behavior) ---
  backToTopBtn.addEventListener("click", (e) => {
    e.preventDefault();
    scrollToTop();
  });

  // --- Mobile: treat touchstart (even a long press) like a tap ---
  backToTopBtn.addEventListener("touchstart", (e) => {
    // prevent default long-press behavior / synthetic click
    e.preventDefault();

    // show pressed feedback immediately
    backToTopBtn.classList.add("pressed");

    // start scrolling right away
    scrollToTop();

    // remove pressed visual quickly so holding doesn't "stick"
    // adjust the ms here if you want the pressed visual to last longer
    setTimeout(resetButtonEffects, 120);
  });

  // ensure cleanup on end/cancel (safety)
  backToTopBtn.addEventListener("touchend", resetButtonEffects);
  backToTopBtn.addEventListener("touchcancel", resetButtonEffects);

  // prevent context menu on long press (optional but helpful on some devices)
  backToTopBtn.addEventListener("contextmenu", (e) => e.preventDefault());
</script>
  
  
</body>
</html>
